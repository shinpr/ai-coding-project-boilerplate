# [機能名] Design Document

## 概要

[この機能の目的と概要を2-3文で説明]

## 背景とコンテキスト

### 前提となるADR

- [ADRファイル名]: [関連する決定事項]
- 共通技術ADRがある場合は参照

### 合意事項チェックリスト

#### スコープ
- [ ] [変更する機能/コンポーネント]
- [ ] [追加する機能]

#### 非スコープ（明示的に変更しないもの）
- [ ] [変更しない機能/コンポーネント]
- [ ] [保持する既存ロジック]

#### 制約条件
- [ ] 並行運用: [あり/なし]
- [ ] 後方互換性: [必要/不要]
- [ ] パフォーマンス測定: [必要/不要]

### 解決する問題

[この機能が解決しようとしている具体的な問題や課題]

### 現状の課題

[現在のシステムの問題点や制限]

### 要件

#### 機能要件

- [必須の機能要件を列挙]

#### 非機能要件

- **パフォーマンス**: [応答時間、スループットなどの要件]
- **スケーラビリティ**: [負荷増加時の対応要件]
- **信頼性**: [エラー率、可用性などの要件]
- **保守性**: [コードの理解しやすさ、変更のしやすさ]

## 受入条件（AC）- EARS形式

各ACはEARS形式で記述。キーワードがテスト種別を決定する。

### [機能要件1]

- [ ] **When** ユーザーが有効な認証情報でログインボタンをクリック, the system shall 認証成功しダッシュボードにリダイレクト
- [ ] **If** 認証情報が無効, **then** the system shall エラーメッセージ「認証情報が正しくありません」を表示
- [ ] **While** ユーザーがログイン状態, the system shall セッションを60分間維持

### [機能要件2]

- [ ] The system shall データ一覧を10件ずつページネーションして表示
- [ ] **When** 検索フィールドに入力, the system shall リアルタイムでフィルタリングを適用

## 既存コードベース分析

### 実装パスマッピング
| 種別 | パス | 説明 |
|------|------|------|
| 既存 | src/[実際のパス] | [現在の実装] |
| 新規 | src/[計画パス] | [新規作成予定] |

### 統合点（新規実装でも記載）
- **統合先**: [どこと接続するか]
- **呼び出し方法**: [どのように呼び出されるか]

## 設計

### 変更影響マップ

```yaml
変更対象: [変更するコンポーネント/機能]
直接影響:
  - [直接変更が必要なファイル/関数]
  - [インターフェース変更箇所]
間接影響:
  - [データ形式の変更]
  - [処理時間の変化]
波及なし:
  - [影響を受けない機能を明示]
```

### アーキテクチャ概要

[システム全体の中でこの機能がどのように位置づけられるか]

### データフロー

```
[データの流れを図や疑似コードで表現]
```

### 統合点一覧

| 統合点 | 場所 | 旧実装 | 新実装 | 切り替え方法 |
|---------|------|----------|----------|-------------|
| 統合点1 | [クラス/関数] | [既存処理] | [新処理] | [DI/ファクトリ等] |
| 統合点2 | [別の箇所] | [既存] | [新規] | [方法] |

### 主要コンポーネント

#### コンポーネント1

- **責務**: [このコンポーネントの責任範囲]
- **インターフェース**: [提供するAPIや型定義]
- **依存関係**: [他のコンポーネントとの関係]

#### コンポーネント2

- **責務**: [このコンポーネントの責任範囲]
- **インターフェース**: [提供するAPIや型定義]
- **依存関係**: [他のコンポーネントとの関係]

### 型定義

```typescript
// 主要な型定義をここに記載
```

### データ契約（Data Contract）

#### コンポーネント1

```yaml
入力:
  型: [TypeScript型定義]
  前提条件: [必須項目、形式制約]
  検証: [バリデーション方法]

出力:
  型: [TypeScript型定義]
  保証: [必ず満たす条件]
  エラー時: [例外/null/デフォルト値]

不変条件:
  - [処理の前後で変わらない条件]
```

### 状態遷移と不変条件（該当する場合）

```yaml
状態定義:
  - 初期状態: [初期値と条件]
  - 遷移可能状態: [状態のリスト]

状態遷移:
  現在状態 → イベント → 次状態

システム不変条件:
  - [どの状態でも成立する条件]
```

### エラーハンドリング

[エラーの種類と対処方法]

### ログとモニタリング

[何をログに記録し、どのようにモニタリングするか]

## 実装計画

### 実装アプローチ

**選択したアプローチ**: [アプローチ名または組み合わせ]
**選択理由**: [プロジェクトの制約と技術的依存関係を考慮した理由]

### 技術的依存関係と実装順序

#### 実装の必要順序
1. **[コンポーネント/機能A]**
   - 技術的理由: [なぜこれを最初に実装する必要があるか]
   - 依存される要素: [これに依存する他のコンポーネント]

2. **[コンポーネント/機能B]**
   - 技術的理由: [Aの後に実装する技術的必然性]
   - 前提条件: [必要な事前実装]

#### 並列実装可能な要素
- [独立して実装可能なコンポーネント群]

### 統合ポイントとE2E確認

#### 統合ポイント1: [統合箇所]
**確認手順**:
1. [動作確認手順]
2. [期待結果の確認]

#### 統合ポイント2: [統合箇所]
**確認手順**:
1. [動作確認手順]
2. [期待結果の確認]

### 移行戦略

[技術的な移行アプローチ、後方互換性の確保方法]

## テスト戦略

### テスト設計の基本方針

受入条件から自動的にテストケースを導出：
- 各受入条件に対して最低1つのテストケースを作成
- 受入条件の測定可能な基準をアサーションとして実装

### 単体テスト

[単体テストの方針とカバレッジ目標]
- 機能受入条件の個別要素を検証

### 統合テスト

[統合テストの方針と重要なテストケース]
- 機能受入条件の結合動作を検証

### E2Eテスト

[E2Eテストの方針]
- 受入条件のシナリオ全体を検証
- ユーザー視点での機能動作を確認

### パフォーマンステスト

[パフォーマンステストの方法と基準]
- 非機能受入条件のパフォーマンス基準を検証

## セキュリティ考慮事項

[セキュリティ上の懸念事項と対策]

## 今後の拡張性

[将来的な機能追加や変更に対する考慮]

## 代替案の検討

### 代替案1

- **概要**: [代替案の説明]
- **利点**: [利点]
- **欠点**: [欠点]
- **不採用の理由**: [なぜ採用しなかったか]

## リスクと軽減策

| リスク | 影響度 | 発生確率 | 軽減策 |
|--------|--------|----------|--------|
| [リスク1] | 高/中/低 | 高/中/低 | [対策] |

## 参考資料

- [関連するドキュメントやリンク]

## 更新履歴

| 日付 | 版 | 変更内容 | 作成者 |
|------|-----|----------|--------|
| YYYY-MM-DD | 1.0 | 初版作成 | [名前] |