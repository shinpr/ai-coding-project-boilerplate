---
description: 対話的にユーザーの知識を収集し、最適化されたスキルを作成
---

**コマンドコンテキスト**: 対話を通じてユーザーの知識を収集し、最適化されたスキルファイルを生成・レビューするワークフロー。

スキルのトピック: $ARGUMENTS

## 実行プロセス

以下のステップをTodoWriteに登録し、順番に進行する。

### Step 1: 事前確認

1. 既存スキルをGlob: `.claude/skills/*/SKILL.md`
2. `$ARGUMENTS`が既存スキル名と一致する場合: `/refine-skill`を提案して終了
3. 既存スキル名の一覧をユーザーに提示

### Step 2: スキル知識の収集

AskUserQuestionで3ラウンドに分けて情報を収集する。

**ラウンド1: スキルの本質**
- このスキルはどのドメイン知識を体系化するか？（1-2文）
- スキル適用時の主な目的は？（例: 「型安全性の確保」「テストパターンの標準化」）

**ラウンド2: スコープと使用場面**
- どのような場面でこのスキルを有効化すべきか？ 具体的なシナリオを3-5個（例: 「ユニットテスト作成時」「セキュリティ観点でのPRレビュー時」）
- このスキルが明示的に扱わない範囲は？（スコープ境界）

**ラウンド3: 判断基準とコンテンツ**
- 具体的なルールや基準は？（体系化すべき中核知識）
- 良い/悪いパターンの具体例は？
- このスキルが準拠する外部参照や標準は？

### Step 3: スキル名と構造の決定

1. 既存の命名規則に従い名詞/動名詞形式のスキル名を導出:
   - `coding-standards`, `typescript-rules`, `implementation-approach`（名詞/動名詞の複合語）
2. 収集した内容量からサイズを見積もり
3. スキル名と構造をAskUserQuestionで確認

### Step 4: スキルコンテンツの生成

収集した情報を渡してskill-creatorエージェントをTask toolで起動:
- ラウンド3の生の知識
- Step 3のスキル名
- ラウンド2の使用場面
- ラウンド2のスコープ
- ラウンド3の判断基準

### Step 5: 生成コンテンツのレビュー

skill-reviewerエージェントをTask toolで起動:
- skill-creatorの生成コンテンツを渡す
- レビューモード: `creation`

グレードC: reviewerの修正提案に基づき修正し再レビュー（最大2回）。
グレードAまたはB: Step 6へ進行。

### Step 6: ユーザー確認と書き込み

1. 生成したSKILL.mdの内容をユーザーに提示し最終承認を取得
2. 意図の整合性を確認: 「このスキルは説明いただいた知識と基準を正しく反映していますか？」
3. 修正要望がある場合: 変更を適用しskill-reviewerを再実行
4. 承認後、`.claude/skills/{スキル名}/SKILL.md`に書き込み
5. `/sync-skills`の実行を提案

## 完了条件

- [ ] 既存スキルとの名前衝突がない
- [ ] 3ラウンドの対話でスキル知識を収集済み
- [ ] スキル名をユーザーが確認済み
- [ ] skill-creatorが有効なJSON出力を返却
- [ ] skill-reviewerがグレードAまたはBを返却
- [ ] ユーザーが最終コンテンツを承認済み
- [ ] `.claude/skills/{スキル名}/SKILL.md`に書き込み済み
- [ ] `/sync-skills`の実行を提案済み

## エラーハンドリング

| エラー | アクション |
|--------|-----------|
| スキル名が既存と重複 | `/refine-skill {スキル名}`を提案 |
| 3ラウンドで知識が不足 | 対象を絞った追加質問（最大2問） |
| skill-creatorが無効なJSONを返却 | 入力を簡素化して1回再試行 |
| 2回のレビューでもグレードC | 現在の内容と問題リストを提示し、ユーザーに判断を委ねる |
| ユーザーが生成内容を却下 | 具体的なフィードバックを収集し、調整してskill-creatorを再実行 |

## スコープ境界

**このコマンドが担当**: 対話による知識収集、creatorとreviewerエージェントの連携、ファイル書き込み。
**このコマンドは担当しない**: スキルコンテンツの最適化ロジック（skill-creatorに委譲）、品質評価ロジック（skill-reviewerに委譲）、メタデータ同期（`/sync-skills`に委譲）。
