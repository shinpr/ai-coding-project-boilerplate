---
description: スキル修正後のメタデータ同期とrule-advisor精度最適化
---

**コマンドコンテキスト**: スキルファイル編集後のメンテナンス作業

## 本質的な目的

単なる整合性維持ではなく、rule-advisorの選択精度向上。スキル編集作業の仕上げとしてのメタデータ最適化。

## 実行プロセス

以下のステップをTodoWriteに登録し、順番に進行する。

### Step 1: スキルファイルのスキャン

- Glob: `.claude/skills/*/SKILL.md` で全スキルファイルを取得
- Read: `.claude/skills/task-analyzer/references/skills-index.yaml` を読み込み

### Step 2: メタデータ同期と最適化

各スキルについて以下を検証：

| メタデータ | 検証内容 |
|-----------|---------|
| sections | SKILL.mdの`## `セクションと100%一致するか |
| tags | ファイル内容のキーワードと適切に一致するか |
| typical-use | 具体的な利用場面を明示しているか |
| key-references | 最新の手法を網羅しているか |

### Step 3: 変更要否の判断

**評価シーケンス**:
- IF sections 100%同期済み → 「同期確認完了、更新不要」と報告して終了
- IF 内容とタグのミスマッチがゼロ → 更新不要と判断して終了
- IF AND ONLY IF 測定可能な改善が存在 → 具体的な修正提案（before/after値を含む）を生成

**注意**: 変更を強制しない。改善が検出されない場合は「修正不要」と報告して終了。

### Step 4: ユーザー承認と適用

提案をユーザーに提示し、承認後に適用：

```
[1/N] typescript-rules
  ✅ sections: 同期完了
  💡 tags提案: +[functional-programming]
  💡 typical-use: "旧記述" → "新記述"
```

## 完了条件

- [ ] 全スキルファイルをスキャンした
- [ ] skills-index.yamlとの整合性を検証した
- [ ] 変更要否を判断した（不要なら報告して終了）
- [ ] 変更がある場合、ユーザー承認を取得した
- [ ] 変更を適用した

## エラーハンドリング

| エラー | アクション |
|--------|-----------|
| skills-index.yaml未発見 | パスを確認し、見つからない場合は報告して終了 |
| SKILL.mdのパースエラー | 該当スキルをスキップし、他を継続 |
| 大量の不整合検出 | 優先度の高いものから段階的に対応を提案 |

## 実行タイミング

- スキルファイル編集後（必須）
- 新しいスキルファイル追加時
- 大規模なスキル改訂後
- rule-advisorの選択精度が低下したと感じた時

**スコープ**: スキル修正作業後のメタデータ同期とrule-advisor精度最適化。
