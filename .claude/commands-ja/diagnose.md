---
description: 問題を調査し、検証を経て解決策を導出する
---

**コマンドコンテキスト**: 問題の根本原因を特定し、解決策を提示するための診断フロー

対象問題: $ARGUMENTS

**TodoWrite登録**: 実行ステップをTodoWriteに登録し、計画的にタスクを進める

## 診断フロー概要

```
問題 → ステップ1:調査 → ステップ2:複雑性判定 → [ステップ3:検証] → ステップ4:解決策導出 → ステップ5:レポート
                                          ↓
                                     単純な場合は
                                     ステップ3スキップ
```

**コンテキスト分離**: 各ステップには構造化JSON出力のみを渡す。思考過程は引き継がない。

## 実行ステップ

### ステップ1: 調査

**Taskツールでの呼び出し**:
```
subagent_type: investigator
prompt: 以下の現象について、関連する情報を網羅的に収集してください。

現象: [ユーザーが報告した問題]
```

**期待される出力**: 証拠マトリクス、未探索領域のリスト、調査の限界

### ステップ2: 複雑性判定

ステップ1の出力を確認し判定：

**ステップ3実行条件（1つでも該当）**:
- 2つ以上の仮説が同程度の証拠を持つ
- 直接証拠がなく間接証拠のみ
- 未探索領域が2つ以上ある
- 仮説に反証する証拠が存在する
- 問題が過去に再発している

**ステップ3スキップ条件（すべて該当）**:
- 1つの仮説が明らかに優勢（直接証拠あり、反証なし）
- 未探索領域がほぼない
- 単発の問題（再発履歴なし）

判定結果をユーザーに報告し、ステップ3をスキップする場合は理由を説明。

### ステップ3: 検証（複雑な場合のみ）

**Taskツールでの呼び出し**:
```
subagent_type: verifier
prompt: 以下の調査結果を検証してください。

調査結果: [ステップ1のJSON出力]
```

**期待される出力**: 代替仮説（最低3つ）、Devil's Advocate評価、最終結論、信頼度

### ステップ4: 解決策導出

**Taskツールでの呼び出し**:
```
subagent_type: solver
prompt: 以下の検証済み結論に基づいて、解決策を導出してください。

結論: [ステップ3またはステップ1の結論部分]
信頼度: [high/medium/low]
```

**期待される出力**: 複数の解決策（最低3つ）、トレードオフ分析、推奨案と実装ステップ

### ステップ5: 最終レポート作成

診断完了後、以下の形式でユーザーに報告：

```
## 診断結果サマリー

### 特定された原因
[検証結果の結論]
信頼度: [high/medium/low]

### 検証プロセス
- 調査範囲: [調査で確認した範囲]
- 検証実施: [はい/いいえ]
- 代替仮説数: [検証で生成した数]

### 推奨する解決策
[解決策導出の推奨案]

理由: [選定理由]

### 実装ステップ
1. [ステップ1]
2. [ステップ2]
...

### 代替案
[代替案の説明]

### 残る不確実性
- [不確実性1]
- [不確実性2]

### 解決後の確認事項
- [確認事項1]
- [確認事項2]
```

## 完了条件

- [ ] ステップ1: 調査を実行し、証拠マトリクスを取得した
- [ ] ステップ2: 複雑性判定を行い、結果をユーザーに報告した
- [ ] ステップ3: （複雑な場合）検証を実行した
- [ ] ステップ4: 解決策導出を実行した
- [ ] ステップ5: 最終レポートをユーザーに提示した
