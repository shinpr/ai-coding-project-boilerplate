---
description: ユーザーのスキル変更要求を最適化パターン評価付きで実装
---

**コマンドコンテキスト**: スキルファイルの変更要求を理解し、品質評価を伴う最適化で実装するワークフロー。

変更要求: $ARGUMENTS

## 実行プロセス

以下のステップをTodoWriteに登録し、順番に進行する。

### Step 1: 変更要求の理解

未指定時はAskUserQuestionで確認：
- どのスキルを変更するか（例: typescript-rules / coding-standards）
- 変更種別: 新基準追加 / 既存基準修正 / 基準削除
- 具体的な変更内容

対象ファイル特定：
- スキル名が明示 → Read: `.claude/skills/{スキル名}/SKILL.md`
- 部分的に判明 → Glob: `.claude/skills/*{キーワード}*/SKILL.md`
- 不明 → Glob: `.claude/skills/*/SKILL.md` で全件確認 → ユーザーに選択

### Step 2: 変更設計案の作成

現状と変更案のbefore/afterを提示：

```
【現状】
"エラーは適切に処理する"（曖昧：「適切」の基準不明）

【変更案】
"エラーハンドリング実装基準：
1. try-catch必須条件：外部API呼び出し、ファイルI/O、JSON.parse等
2. エラーログ必須項目：error.name、error.stack、タイムスタンプ"

この設計で進めますか？ (y/n)
```

**設計チェックリスト**: skill-optimizationスキルの9つの編集原則に照らして設計案を評価。重点項目：
- コンテキスト効率: 追加する全文がLLMの判断に寄与するか
- 測定可能性: 全基準がif-then形式または具体的閾値か
- 重複排除: 他スキルファイルとの重複がないか
- スコープ境界: 変更内容がこのスキルの責務範囲内か

### Step 3: 品質レビュー

skill-reviewerエージェントをTask toolで起動:
- 変更後のSKILL.md全文を渡す
- レビューモード: `modification`

**レビュー結果の処理:**
- グレードAまたはB: Step 4へ進行
- グレードC: reviewerの修正提案に基づき修正し再レビュー（最大2回）
- 変更スコープ外の問題を検出: 別の改善機会としてユーザーに報告

### Step 4: 承認取得と実装

1. 変更前後の比較をユーザーに提示し承認を取得
2. skill-reviewerのグレードと残存する修正提案を提示
3. 意図の整合性を確認: 「この変更は当初の要求を正しく反映していますか？」
4. 適切なツールで変更適用
5. git diffで変更内容を最終確認
6. 変更スコープ外の問題があれば、任意の改善事項として提示
7. `/sync-skills`実行を提案

## 完了条件

- [ ] 対象スキルを特定し現状を把握した
- [ ] skill-optimizationの編集原則に照らして設計案をレビューした
- [ ] skill-reviewerがグレードAまたはBを返却した
- [ ] ユーザー承認を取得した
- [ ] 変更を適用しgit diffで確認した
- [ ] /sync-skills実行を提案した

## エラーハンドリング

| エラー | アクション |
|--------|-----------|
| スキル未発見 | 利用可能なスキル一覧を表示 |
| 大規模変更検出（ファイルの50%以上） | 段階的実施を提案 |
| 他スキルとの責務重複 | 責務境界を確認しユーザーに判断を委ねる |
| 2回のレビューでもグレードC | 変更内容と問題リストを提示し、ユーザーに判断を委ねる |
| reviewerが退行を検出 | 退行原因の変更を取り消し、再レビュー |

**スコープ**: ユーザーの変更要求理解と品質評価付き最適化実装。品質評価はskill-reviewerエージェントに委譲。メタデータ同期は/sync-skills連携。
